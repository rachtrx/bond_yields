2023-12-31 20:08:20,365 - root - INFO - Table asset already exists.
2023-12-31 20:08:20,367 - root - INFO - Table bond_yield already exists.
2023-12-31 20:08:20,368 - root - INFO - Table bond_yield_realtime already exists.
2023-12-31 20:08:32,572 - root - INFO - Proxy and database are running. Starting main functionality.
2023-12-31 20:09:24,605 - root - INFO - Creating table: asset
2023-12-31 20:09:24,624 - root - INFO - Creating table: bond_yield
2023-12-31 20:09:24,638 - root - INFO - Creating table: bond_yield_realtime
2023-12-31 20:09:36,741 - root - INFO - Proxy and database are running. Starting main functionality.
2023-12-31 20:11:00,641 - root - INFO - https://www.investing.com/rates-bonds/australia-5-year-bond-yield-historical-data
2023-12-31 20:11:00,641 - root - INFO - https://www.investing.com/rates-bonds/australia-2-year-bond-yield-historical-data
2023-12-31 20:11:56,616 - logger_23870 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:11:56,765 - logger_23873 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:12:03,351 - root - INFO - https://www.investing.com/rates-bonds/austria-2-year-bond-yield-historical-data
2023-12-31 20:12:04,162 - root - INFO - https://www.investing.com/rates-bonds/austria-5-year-bond-yield-historical-data
2023-12-31 20:13:00,295 - logger_23854 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:13:01,389 - logger_23857 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:13:07,217 - root - INFO - https://www.investing.com/rates-bonds/bahrain-2-year-historical-data
2023-12-31 20:13:08,151 - root - INFO - https://www.investing.com/rates-bonds/bahrain-5-year-historical-data
2023-12-31 20:13:25,739 - logger_1052505 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:13:26,658 - logger_1052507 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:13:33,874 - root - INFO - https://www.investing.com/rates-bonds/bangladesh-2-year-historical-data
2023-12-31 20:13:33,934 - root - INFO - https://www.investing.com/rates-bonds/bangladesh-5-year-historical-data
2023-12-31 20:13:54,928 - logger_1052589 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:13:57,618 - logger_1052591 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:14:03,829 - root - INFO - https://www.investing.com/rates-bonds/belguim-2-year-bond-yield-historical-data
2023-12-31 20:14:04,460 - root - INFO - https://www.investing.com/rates-bonds/belguim-5-year-bond-yield-historical-data
2023-12-31 20:15:01,213 - logger_23818 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:15:02,225 - logger_23821 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:15:07,725 - root - INFO - https://www.investing.com/rates-bonds/brazil-2-year-bond-yield-historical-data
2023-12-31 20:15:08,513 - root - INFO - https://www.investing.com/rates-bonds/brazil-5-year-bond-yield-historical-data
2023-12-31 20:15:42,915 - logger_24027 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:15:45,627 - logger_24025 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:15:50,364 - root - INFO - https://www.investing.com/rates-bonds/bulgaria-2-year-bond-yield-historical-data
2023-12-31 20:15:52,706 - root - INFO - https://www.investing.com/rates-bonds/bulgaria-5-year-bond-yield-historical-data
2023-12-31 20:16:01,192 - logger_1173525 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:16:09,972 - root - INFO - https://www.investing.com/rates-bonds/canada-2-year-bond-yield-historical-data
2023-12-31 20:16:40,396 - logger_23994 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:16:47,605 - root - INFO - https://www.investing.com/rates-bonds/canada-5-year-bond-yield-historical-data
2023-12-31 20:17:09,972 - logger_25270 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:17:16,858 - root - INFO - https://www.investing.com/rates-bonds/chile-2-year-bond-yield-historical-data
2023-12-31 20:17:35,706 - logger_25273 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:17:43,902 - root - INFO - https://www.investing.com/rates-bonds/chile-5-year-bond-yield-historical-data
2023-12-31 20:17:47,125 - logger_29219 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:17:54,106 - root - INFO - https://www.investing.com/rates-bonds/china-2-year-bond-yield-historical-data
2023-12-31 20:18:14,912 - logger_29222 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:18:26,329 - root - INFO - https://www.investing.com/rates-bonds/china-5-year-bond-yield-historical-data
2023-12-31 20:18:40,094 - logger_29232 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:18:51,184 - root - INFO - https://www.investing.com/rates-bonds/colombia-2-year-bond-yield-historical-data
2023-12-31 20:19:02,262 - logger_29234 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:19:11,607 - root - INFO - https://www.investing.com/rates-bonds/colombia-5-year-bond-yield-historical-data
2023-12-31 20:19:28,572 - logger_29238 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:19:40,428 - root - INFO - https://www.investing.com/rates-bonds/croatia-2-year-historical-data
2023-12-31 20:19:57,583 - logger_1199848 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:19:59,031 - logger_29240 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:20:06,420 - root - INFO - https://www.investing.com/rates-bonds/croatia-5-year-bond-yield-historical-data
2023-12-31 20:20:07,439 - root - INFO - https://www.investing.com/rates-bonds/czech-republic-2-year-bond-yield-historical-data
2023-12-31 20:20:46,829 - logger_24001 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:20:57,363 - root - INFO - https://www.investing.com/rates-bonds/czech-republic-5-year-bond-yield-historical-data
2023-12-31 20:21:19,481 - logger_29249 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:21:27,232 - root - INFO - https://www.investing.com/rates-bonds/denmark-2-year-bond-yield-historical-data
2023-12-31 20:21:46,667 - logger_29252 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:21:55,756 - root - INFO - https://www.investing.com/rates-bonds/denmark-5-year-bond-yield-historical-data
2023-12-31 20:22:18,488 - logger_23834 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:22:27,989 - root - INFO - https://www.investing.com/rates-bonds/egypt-2-year-historical-data
2023-12-31 20:22:47,216 - logger_23836 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:22:49,191 - logger_1052495 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:22:54,951 - root - INFO - https://www.investing.com/rates-bonds/egypt-5-year-bond-yield-historical-data
2023-12-31 20:22:56,528 - root - INFO - https://www.investing.com/rates-bonds/finland-2-year-bond-yield-historical-data
2023-12-31 20:23:26,444 - logger_40643 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:23:37,673 - root - INFO - https://www.investing.com/rates-bonds/finland-5-year-bond-yield-historical-data
2023-12-31 20:23:49,315 - logger_23845 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:24:02,100 - root - INFO - https://www.investing.com/rates-bonds/france-2-year-bond-yield-historical-data
2023-12-31 20:24:27,682 - logger_23848 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:24:33,912 - root - INFO - https://www.investing.com/rates-bonds/france-5-year-bond-yield-historical-data
2023-12-31 20:24:53,732 - logger_23770 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:25:00,474 - root - INFO - https://www.investing.com/rates-bonds/germany-2-year-bond-yield-historical-data
2023-12-31 20:25:23,873 - logger_23773 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:25:30,590 - root - INFO - https://www.investing.com/rates-bonds/germany-5-year-bond-yield-historical-data
2023-12-31 20:25:49,469 - logger_23685 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:25:56,665 - root - INFO - https://www.investing.com/rates-bonds/greece-2-year-bond-yield-historical-data
2023-12-31 20:26:22,099 - logger_23688 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:26:26,480 - logger_23979 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:26:28,630 - root - INFO - https://www.investing.com/rates-bonds/greece-5-year-bond-yield-historical-data
2023-12-31 20:26:33,065 - root - INFO - https://www.investing.com/rates-bonds/hong-kong-2-year-bond-yield-historical-data
2023-12-31 20:27:19,439 - logger_23981 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:27:24,185 - logger_23912 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:27:26,275 - root - INFO - https://www.investing.com/rates-bonds/hong-kong-5-year-bond-yield-historical-data
2023-12-31 20:27:30,710 - root - INFO - https://www.investing.com/rates-bonds/iceland-2-year-bond-yield-historical-data
2023-12-31 20:28:08,382 - logger_29225 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:28:13,731 - logger_23915 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:28:14,793 - root - INFO - https://www.investing.com/rates-bonds/iceland-5-year-bond-yield-historical-data
2023-12-31 20:28:20,264 - root - INFO - https://www.investing.com/rates-bonds/india-2-year-bond-yield-historical-data
2023-12-31 20:28:56,582 - logger_29226 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:28:58,892 - logger_24006 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:29:02,660 - root - INFO - https://www.investing.com/rates-bonds/india-5-year-bond-yield-historical-data
2023-12-31 20:29:05,480 - root - INFO - https://www.investing.com/rates-bonds/ireland-2-year-bond-yield-historical-data
2023-12-31 20:29:44,844 - logger_29268 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:29:51,397 - root - INFO - https://www.investing.com/rates-bonds/ireland-5-year-bond-yield-historical-data
2023-12-31 20:29:56,529 - logger_24009 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:30:05,537 - root - INFO - https://www.investing.com/rates-bonds/israel-2-year-historical-data
2023-12-31 20:30:32,648 - logger_1052482 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:30:38,973 - root - INFO - https://www.investing.com/rates-bonds/israel-5-year-bond-yield-historical-data
2023-12-31 20:30:40,512 - logger_29270 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:30:48,318 - root - INFO - https://www.investing.com/rates-bonds/italy-2-year-bond-yield-historical-data
2023-12-31 20:31:22,587 - logger_24043 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:31:28,887 - root - INFO - https://www.investing.com/rates-bonds/italy-5-year-bond-yield-historical-data
2023-12-31 20:31:58,413 - logger_23730 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:32:04,743 - root - INFO - https://www.investing.com/rates-bonds/japan-2-year-bond-yield-historical-data
2023-12-31 20:32:22,352 - logger_23733 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:32:30,322 - root - INFO - https://www.investing.com/rates-bonds/japan-5-year-bond-yield-historical-data
2023-12-31 20:32:45,283 - logger_23893 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:32:54,279 - root - INFO - https://www.investing.com/rates-bonds/kazakhstan-2-year-historical-data
2023-12-31 20:33:08,718 - logger_1173024 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:33:09,377 - logger_23896 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:33:16,404 - root - INFO - https://www.investing.com/rates-bonds/kazakhstan-5-year-historical-data
2023-12-31 20:33:16,613 - root - INFO - https://www.investing.com/rates-bonds/kenya-2-year-bond-yield-historical-data
2023-12-31 20:33:33,206 - logger_1173027 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:33:42,842 - root - INFO - https://www.investing.com/rates-bonds/kenya-5-year-bond-yield-historical-data
2023-12-31 20:33:54,661 - logger_29284 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:34:07,116 - root - INFO - https://www.investing.com/rates-bonds/latvia-2-years-bond-yield-historical-data
2023-12-31 20:34:18,678 - logger_29287 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:34:29,897 - root - INFO - https://www.investing.com/rates-bonds/latvia-5-years-bond-yield-historical-data
2023-12-31 20:34:41,025 - logger_42392 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:34:53,674 - root - INFO - https://www.investing.com/rates-bonds/mauritius-2-year-historical-data
2023-12-31 20:35:01,118 - logger_42391 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:35:11,513 - logger_1052563 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:35:15,026 - root - INFO - https://www.investing.com/rates-bonds/mauritius-5-year-historical-data
2023-12-31 20:35:18,571 - root - INFO - https://www.investing.com/rates-bonds/morocco-2-year-historical-data
2023-12-31 20:35:36,917 - logger_1052566 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:35:45,190 - logger_1052498 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:35:47,609 - root - INFO - https://www.investing.com/rates-bonds/morocco-5-year-historical-data
2023-12-31 20:35:51,955 - root - INFO - https://www.investing.com/rates-bonds/netherlands-2-year-bond-yield-historical-data
2023-12-31 20:36:14,885 - logger_1052500 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:36:29,193 - root - INFO - https://www.investing.com/rates-bonds/netherlands-5-year-bond-yield-historical-data
2023-12-31 20:36:55,518 - logger_23743 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:37:01,894 - root - INFO - https://www.investing.com/rates-bonds/new-zealand-2-years-bond-yield-historical-data
2023-12-31 20:37:21,710 - logger_23746 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:37:29,197 - root - INFO - https://www.investing.com/rates-bonds/new-zealand-5-years-bond-yield-historical-data
2023-12-31 20:37:48,668 - logger_42407 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:37:55,481 - root - INFO - https://www.investing.com/rates-bonds/nigeria-2-year-historical-data
2023-12-31 20:38:10,914 - logger_42408 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:38:21,264 - root - INFO - https://www.investing.com/rates-bonds/nigeria-5-year-historical-data
2023-12-31 20:38:28,554 - logger_1052571 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:38:40,759 - root - INFO - https://www.investing.com/rates-bonds/peru-2-year-historical-data
2023-12-31 20:38:50,193 - logger_1052574 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:38:53,922 - logger_1141798 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:39:00,988 - root - INFO - https://www.investing.com/rates-bonds/peru-5-year-bond-yield-historical-data
2023-12-31 20:39:01,167 - root - INFO - https://www.investing.com/rates-bonds/philippines-2-year-bond-yield-historical-data
2023-12-31 20:39:19,218 - logger_29320 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:39:33,214 - root - INFO - https://www.investing.com/rates-bonds/philippines-5-year-bond-yield-historical-data
2023-12-31 20:39:45,595 - logger_29329 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:39:57,433 - root - INFO - https://www.investing.com/rates-bonds/poland-2-year-bond-yield-historical-data
2023-12-31 20:40:13,390 - logger_29332 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:40:23,225 - root - INFO - https://www.investing.com/rates-bonds/poland-5-year-bond-yield-historical-data
2023-12-31 20:40:50,594 - logger_23940 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:40:57,449 - root - INFO - https://www.investing.com/rates-bonds/portugal-2-year-bond-yield-historical-data
2023-12-31 20:41:14,890 - logger_23943 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:41:23,090 - root - INFO - https://www.investing.com/rates-bonds/portugal-5-year-bond-yield-historical-data
2023-12-31 20:41:49,899 - logger_23784 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:41:56,059 - root - INFO - https://www.investing.com/rates-bonds/qatar-2-year-bond-yield-historical-data
2023-12-31 20:42:14,746 - logger_23787 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:42:16,714 - logger_29204 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:42:22,899 - root - INFO - https://www.investing.com/rates-bonds/qatar-5-year-historical-data
2023-12-31 20:42:23,693 - root - INFO - https://www.investing.com/rates-bonds/romania-2-year-historical-data
2023-12-31 20:42:52,628 - logger_1052511 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:42:57,902 - logger_1199850 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:43:05,222 - root - INFO - https://www.investing.com/rates-bonds/romania-5-year-bond-yield-historical-data
2023-12-31 20:43:05,893 - root - INFO - https://www.investing.com/rates-bonds/russia-2-year-bond-yield-historical-data
2023-12-31 20:43:46,169 - logger_23989 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:43:51,781 - logger_23971 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:43:52,082 - root - INFO - https://www.investing.com/rates-bonds/russia-5-year-bond-yield-historical-data
2023-12-31 20:43:58,143 - root - INFO - https://www.investing.com/rates-bonds/serbia-2-year-historical-data
2023-12-31 20:44:36,009 - logger_1052578 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:44:37,588 - logger_23973 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:44:42,403 - root - INFO - https://www.investing.com/rates-bonds/serbia-5-year-historical-data
2023-12-31 20:44:44,568 - root - INFO - https://www.investing.com/rates-bonds/singapore-2-year-bond-yield-historical-data
2023-12-31 20:45:18,259 - logger_1052581 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:45:26,037 - root - INFO - https://www.investing.com/rates-bonds/singapore-5-year-bond-yield-historical-data
2023-12-31 20:45:39,275 - logger_23885 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:45:51,155 - root - INFO - https://www.investing.com/rates-bonds/slovakia-2-year-bond-yield-historical-data
2023-12-31 20:46:19,104 - logger_23886 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:46:26,035 - root - INFO - https://www.investing.com/rates-bonds/slovakia-5-year-bond-yield-historical-data
2023-12-31 20:46:30,985 - logger_29337 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:46:39,798 - root - INFO - https://www.investing.com/rates-bonds/south-korea-2-year-bond-yield-historical-data
2023-12-31 20:47:07,558 - logger_29339 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:47:14,856 - root - INFO - https://www.investing.com/rates-bonds/south-korea-5-year-bond-yield-historical-data
2023-12-31 20:47:36,919 - logger_29295 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:47:43,402 - root - INFO - https://www.investing.com/rates-bonds/spain-2-year-bond-yield-historical-data
2023-12-31 20:48:12,352 - logger_29298 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:48:18,552 - root - INFO - https://www.investing.com/rates-bonds/spain-5-year-bond-yield-historical-data
2023-12-31 20:48:31,759 - logger_23798 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:48:42,236 - root - INFO - https://www.investing.com/rates-bonds/sri-lanka-2-year-bond-yield-historical-data
2023-12-31 20:49:11,053 - logger_23801 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:49:16,768 - logger_29347 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:49:17,931 - root - INFO - https://www.investing.com/rates-bonds/sri-lanka-5-year-bond-yield-historical-data
2023-12-31 20:49:24,521 - root - INFO - https://www.investing.com/rates-bonds/sweden-2-year-bond-yield-historical-data
2023-12-31 20:49:51,164 - logger_29350 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:50:03,434 - root - INFO - https://www.investing.com/rates-bonds/sweden-5-year-bond-yield-historical-data
2023-12-31 20:50:26,568 - logger_23814 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:50:33,088 - root - INFO - https://www.investing.com/rates-bonds/switzerland-2-year-bond-yield-historical-data
2023-12-31 20:50:54,051 - logger_24039 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:51:01,018 - root - INFO - https://www.investing.com/rates-bonds/switzerland-5-year-bond-yield-historical-data
2023-12-31 20:51:19,628 - logger_23714 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:51:27,357 - root - INFO - https://www.investing.com/rates-bonds/taiwan-2-year-bond-yield-historical-data
2023-12-31 20:51:49,846 - logger_23717 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:51:56,328 - root - INFO - https://www.investing.com/rates-bonds/taiwan-5-year-bond-yield-historical-data
2023-12-31 20:52:05,024 - logger_29358 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:52:18,165 - root - INFO - https://www.investing.com/rates-bonds/thailand-2-year-bond-yield-historical-data
2023-12-31 20:52:44,020 - logger_29359 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:52:50,273 - root - INFO - https://www.investing.com/rates-bonds/thailand-5-year-bond-yield-historical-data
2023-12-31 20:52:56,853 - logger_29366 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:53:11,488 - root - INFO - https://www.investing.com/rates-bonds/turkey-2-year-bond-yield-historical-data
2023-12-31 20:53:30,542 - logger_29367 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:53:38,893 - root - INFO - https://www.investing.com/rates-bonds/turkey-5-year-bond-yield-historical-data
2023-12-31 20:53:48,541 - logger_24034 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:54:02,247 - root - INFO - https://www.investing.com/rates-bonds/uganda-2-years-bond-yield-historical-data
2023-12-31 20:54:17,749 - logger_24036 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:54:30,143 - logger_42342 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:54:30,539 - root - INFO - https://www.investing.com/rates-bonds/uganda-5-years-bond-yield-historical-data
2023-12-31 20:54:37,630 - root - INFO - https://www.investing.com/rates-bonds/uk-2-year-bond-yield-historical-data
2023-12-31 20:54:59,615 - logger_42326 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:55:12,366 - root - INFO - https://www.investing.com/rates-bonds/uk-5-year-bond-yield-historical-data
2023-12-31 20:55:36,599 - logger_23665 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:55:43,162 - root - INFO - https://www.investing.com/rates-bonds/u.s.-2-year-bond-yield-historical-data
2023-12-31 20:56:04,053 - logger_23668 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:56:11,197 - root - INFO - https://www.investing.com/rates-bonds/u.s.-5-year-bond-yield-historical-data
2023-12-31 20:56:35,991 - logger_23701 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:56:42,969 - root - INFO - https://www.investing.com/rates-bonds/vietnam-2-year-bond-yield-historical-data
2023-12-31 20:57:01,601 - logger_23703 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:57:08,546 - root - INFO - https://www.investing.com/rates-bonds/vietnam-5-year-bond-yield-historical-data
2023-12-31 20:57:16,087 - logger_29381 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:57:31,427 - root - INFO - https://www.investing.com/rates-bonds/zambia-2-year-historical-data
2023-12-31 20:57:37,958 - logger_29383 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:57:47,102 - root - INFO - https://www.investing.com/rates-bonds/zambia-5-year-historical-data
2023-12-31 20:57:54,786 - logger_1199820 - INFO - FILE ADDED TO DATABASE
2023-12-31 20:58:11,296 - logger_1199823 - INFO - FILE ADDED TO DATABASE
2024-01-01 18:47:41,668 - root - INFO - Table asset already exists.
2024-01-01 18:47:41,669 - root - INFO - Table bond_yield already exists.
2024-01-01 18:47:41,671 - root - INFO - Table bond_yield_realtime already exists.
2024-01-01 18:48:38,956 - root - INFO - Table asset already exists.
2024-01-01 18:48:38,958 - root - INFO - Table bond_yield already exists.
2024-01-01 18:48:38,959 - root - INFO - Table bond_yield_realtime already exists.
2024-01-02 10:04:34,061 - root - INFO - Table asset already exists.
2024-01-02 10:04:34,063 - root - INFO - Table bond_yield already exists.
2024-01-02 10:04:34,065 - root - INFO - Table bond_yield_realtime already exists.
2024-01-02 10:05:29,351 - root - INFO - Table asset already exists.
2024-01-02 10:05:29,352 - root - INFO - Table bond_yield already exists.
2024-01-02 10:05:29,353 - root - INFO - Table bond_yield_realtime already exists.
2024-01-02 18:34:53,701 - root - INFO - Table asset already exists.
2024-01-02 18:34:53,703 - root - INFO - Table bond_yield already exists.
2024-01-02 18:34:53,704 - root - INFO - Creating table: bond_yield_realtime
2024-01-02 18:40:01,209 - root - INFO - Table asset already exists.
2024-01-02 18:40:01,210 - root - INFO - Table bond_yield already exists.
2024-01-02 18:40:01,211 - root - INFO - Table bond_yield_realtime already exists.
2024-01-02 18:43:16,107 - root - INFO - Table asset already exists.
2024-01-02 18:43:16,109 - root - INFO - Table bond_yield already exists.
2024-01-02 18:43:16,109 - root - INFO - Table bond_yield_realtime already exists.
2024-01-03 02:44:01,741 - logger_realtime_data - INFO - entry
2024-01-03 02:45:02,248 - logger_realtime_data - INFO - entry
2024-01-02 18:45:54,991 - root - INFO - Table asset already exists.
2024-01-02 18:45:54,999 - root - INFO - Table bond_yield already exists.
2024-01-02 18:45:55,000 - root - INFO - Table bond_yield_realtime already exists.
2024-01-03 02:46:01,776 - logger_realtime_data - INFO - entry
2024-01-03 02:47:01,777 - logger_realtime_data - INFO - entry
2024-01-02 18:57:04,766 - root - INFO - Table asset already exists.
2024-01-02 18:57:04,768 - root - INFO - Table bond_yield already exists.
2024-01-02 18:57:04,770 - root - INFO - Table bond_yield_realtime already exists.
2024-01-03 02:58:02,677 - logger_realtime_data - INFO - entry
2024-01-03 02:59:02,005 - logger_realtime_data - INFO - entry
2024-01-02 19:00:49,130 - root - INFO - Table asset already exists.
2024-01-02 19:00:49,132 - root - INFO - Table bond_yield already exists.
2024-01-02 19:00:49,134 - root - INFO - Table bond_yield_realtime already exists.
2024-01-03 03:01:02,204 - logger_realtime_data - INFO - entry
2024-01-03 03:02:01,639 - logger_realtime_data - INFO - entry
2024-01-02 19:04:36,046 - root - INFO - Table asset already exists.
2024-01-02 19:04:36,053 - root - INFO - Table bond_yield already exists.
2024-01-02 19:04:36,054 - root - INFO - Table bond_yield_realtime already exists.
2024-01-03 03:05:01,798 - logger_realtime_data - INFO - entry
2024-01-03 03:06:02,051 - logger_realtime_data - INFO - entry
2024-01-03 03:07:02,209 - logger_realtime_data - INFO - entry
2024-01-03 03:08:02,338 - logger_realtime_data - INFO - entry
2024-01-02 19:08:32,442 - root - INFO - Table asset already exists.
2024-01-02 19:08:32,443 - root - INFO - Table bond_yield already exists.
2024-01-02 19:08:32,444 - root - INFO - Table bond_yield_realtime already exists.
2024-01-03 03:09:02,283 - logger_realtime_data - INFO - entry
2024-01-03 03:10:02,186 - logger_realtime_data - INFO - entry
2024-01-03 03:11:02,477 - logger_realtime_data - INFO - entry
2024-01-02 19:11:59,832 - root - INFO - Table asset already exists.
2024-01-02 19:11:59,834 - root - INFO - Table bond_yield already exists.
2024-01-02 19:11:59,835 - root - INFO - Table bond_yield_realtime already exists.
2024-01-03 03:12:02,610 - logger_realtime_data - INFO - entry
2024-01-03 03:13:02,470 - logger_realtime_data - INFO - entry
2024-01-02 19:13:57,960 - root - INFO - Table asset already exists.
2024-01-02 19:13:57,961 - root - INFO - Table bond_yield already exists.
2024-01-02 19:13:57,962 - root - INFO - Table bond_yield_realtime already exists.
2024-01-03 03:14:01,689 - logger_realtime_data - INFO - entry
2024-01-03 03:14:24,462 - urllib3.connectionpool - WARNING - Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fcc0093c260>: Failed to establish a new connection: [Errno 111] Connection refused')': /session/a3f5bd44-e642-4e32-8558-5a123b3bf769
2024-01-03 03:14:24,463 - urllib3.connectionpool - WARNING - Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fcc0093c410>: Failed to establish a new connection: [Errno 111] Connection refused')': /session/a3f5bd44-e642-4e32-8558-5a123b3bf769
2024-01-03 03:14:24,464 - urllib3.connectionpool - WARNING - Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fcc0093c590>: Failed to establish a new connection: [Errno 111] Connection refused')': /session/a3f5bd44-e642-4e32-8558-5a123b3bf769
2024-01-03 03:14:24,488 - logger_realtime_data - INFO - 2024-01-03 03:14:00+08:00
2024-01-03 03:14:24,500 - logger_realtime_data - INFO - 2024-01-03 03:14:24.488804+08:00
2024-01-03 03:14:24,586 - logger_realtime_data - INFO - Traceback (most recent call last):
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "is_open" of relation "bond_yield_realtime" violates not-null constraint
DETAIL:  Failing row contains (2024-01-02 19:14:00, 1, 3.772, 1, null, null).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/app/bonds_sync_realtime.py", line 60, in write_to_database
    BondYieldRealtime(
  File "<string>", line 4, in __init__
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/state.py", line 566, in _initialize_instance
    with util.safe_reraise():
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/state.py", line 564, in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
  File "/home/app/models/bond.py", line 62, in __init__
    db.session.commit()
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/scoping.py", line 598, in commit
    return self._proxied.commit()
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1969, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1256, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1231, in _prepare_impl
    self.session.flush()
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4312, in flush
    self._flush(objects)
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4447, in _flush
    with util.safe_reraise():
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4408, in _flush
    flush_context.execute()
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1043, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "is_open" of relation "bond_yield_realtime" violates not-null constraint
DETAIL:  Failing row contains (2024-01-02 19:14:00, 1, 3.772, 1, null, null).

[SQL: INSERT INTO bond_yield_realtime (datetime, asset_id, bond_yield, timeframe) VALUES (%(datetime)s, %(asset_id)s, %(bond_yield)s, %(timeframe)s)]
[parameters: {'datetime': datetime.datetime(2024, 1, 3, 3, 14, tzinfo=<DstTzInfo 'Asia/Singapore' +08+8:00:00 STD>), 'asset_id': 1, 'bond_yield': 3.772, 'timeframe': 1}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

2024-01-03 03:15:03,073 - logger_realtime_data - INFO - entry
2024-01-03 03:15:19,474 - urllib3.connectionpool - WARNING - Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f8940af4140>: Failed to establish a new connection: [Errno 111] Connection refused')': /session/3da607c6-9a8f-4a81-a47e-29ab7be10292
2024-01-03 03:15:19,475 - urllib3.connectionpool - WARNING - Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f8940af4200>: Failed to establish a new connection: [Errno 111] Connection refused')': /session/3da607c6-9a8f-4a81-a47e-29ab7be10292
2024-01-03 03:15:19,476 - urllib3.connectionpool - WARNING - Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f8940af43b0>: Failed to establish a new connection: [Errno 111] Connection refused')': /session/3da607c6-9a8f-4a81-a47e-29ab7be10292
2024-01-03 03:15:19,496 - logger_realtime_data - INFO - 2024-01-03 03:15:00+08:00
2024-01-03 03:15:19,498 - logger_realtime_data - INFO - 2024-01-03 03:15:19.496192+08:00
2024-01-03 03:15:19,560 - logger_realtime_data - INFO - Traceback (most recent call last):
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "is_open" of relation "bond_yield_realtime" violates not-null constraint
DETAIL:  Failing row contains (2024-01-02 19:15:00, 1, 3.772, 15, null, null).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/app/bonds_sync_realtime.py", line 60, in write_to_database
    BondYieldRealtime(
  File "<string>", line 4, in __init__
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/state.py", line 566, in _initialize_instance
    with util.safe_reraise():
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/state.py", line 564, in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
  File "/home/app/models/bond.py", line 62, in __init__
    db.session.commit()
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/scoping.py", line 598, in commit
    return self._proxied.commit()
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1969, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1256, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1231, in _prepare_impl
    self.session.flush()
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4312, in flush
    self._flush(objects)
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4447, in _flush
    with util.safe_reraise():
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4408, in _flush
    flush_context.execute()
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1043, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "is_open" of relation "bond_yield_realtime" violates not-null constraint
DETAIL:  Failing row contains (2024-01-02 19:15:00, 1, 3.772, 15, null, null).

[SQL: INSERT INTO bond_yield_realtime (datetime, asset_id, bond_yield, timeframe) VALUES (%(datetime)s, %(asset_id)s, %(bond_yield)s, %(timeframe)s)]
[parameters: {'datetime': datetime.datetime(2024, 1, 3, 3, 15, tzinfo=<DstTzInfo 'Asia/Singapore' +08+8:00:00 STD>), 'asset_id': 1, 'bond_yield': 3.772, 'timeframe': 15}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

2024-01-02 19:17:58,842 - root - INFO - Table asset already exists.
2024-01-02 19:17:58,844 - root - INFO - Table bond_yield already exists.
2024-01-02 19:17:58,845 - root - INFO - Table bond_yield_realtime already exists.
2024-01-03 03:18:02,582 - logger_realtime_data - INFO - entry
2024-01-03 03:18:18,589 - urllib3.connectionpool - WARNING - Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f95b6200650>: Failed to establish a new connection: [Errno 111] Connection refused')': /session/9dd59435-109d-4d77-8a26-0866004a478a
2024-01-03 03:18:18,590 - urllib3.connectionpool - WARNING - Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f95b6200110>: Failed to establish a new connection: [Errno 111] Connection refused')': /session/9dd59435-109d-4d77-8a26-0866004a478a
2024-01-03 03:18:18,591 - urllib3.connectionpool - WARNING - Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f95b62009b0>: Failed to establish a new connection: [Errno 111] Connection refused')': /session/9dd59435-109d-4d77-8a26-0866004a478a
2024-01-03 03:18:18,607 - logger_realtime_data - INFO - 2024-01-03 03:18:00+08:00
2024-01-03 03:18:18,609 - logger_realtime_data - INFO - 2024-01-03 03:18:18.607075+08:00
2024-01-03 03:18:18,630 - logger_realtime_data - INFO - Traceback (most recent call last):
  File "/home/app/bonds_sync_realtime.py", line 56, in write_to_database
    latest_entry = BondYieldRealtime.latest_entry(asset.id)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: type object 'BondYieldRealtime' has no attribute 'latest_entry'

2024-01-02 19:18:46,152 - root - INFO - Table asset already exists.
2024-01-02 19:18:46,154 - root - INFO - Table bond_yield already exists.
2024-01-02 19:18:46,156 - root - INFO - Table bond_yield_realtime already exists.
2024-01-03 03:19:02,033 - logger_realtime_data - INFO - entry
2024-01-03 03:19:22,146 - urllib3.connectionpool - WARNING - Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f4261e50260>: Failed to establish a new connection: [Errno 111] Connection refused')': /session/ff397391-2416-4a98-b929-1d535adb2239
2024-01-03 03:19:22,152 - urllib3.connectionpool - WARNING - Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f4261e50cb0>: Failed to establish a new connection: [Errno 111] Connection refused')': /session/ff397391-2416-4a98-b929-1d535adb2239
2024-01-03 03:19:22,156 - urllib3.connectionpool - WARNING - Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f4261e50e30>: Failed to establish a new connection: [Errno 111] Connection refused')': /session/ff397391-2416-4a98-b929-1d535adb2239
2024-01-03 03:19:22,177 - logger_realtime_data - INFO - 2024-01-03 03:19:00+08:00
2024-01-03 03:19:22,188 - logger_realtime_data - INFO - 2024-01-03 03:19:22.177267+08:00
2024-01-03 03:19:22,211 - logger_realtime_data - INFO - Traceback (most recent call last):
  File "/home/app/bonds_sync_realtime.py", line 56, in write_to_database
    latest_entry = BondYieldRealtime.latest_entry(asset.id)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/app/models/bond.py", line 66, in latest_entry
    return cls.query.filter_by(
           ^^^^^^^^^^^^^^^^^^^^
TypeError: Query.filter_by() takes 1 positional argument but 2 were given

2024-01-02 19:20:45,321 - root - INFO - Table asset already exists.
2024-01-02 19:20:45,322 - root - INFO - Table bond_yield already exists.
2024-01-02 19:20:45,323 - root - INFO - Table bond_yield_realtime already exists.
2024-01-03 03:21:02,071 - logger_realtime_data - INFO - entry
2024-01-03 03:21:20,153 - urllib3.connectionpool - WARNING - Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f78aa8f00b0>: Failed to establish a new connection: [Errno 111] Connection refused')': /session/d807bb88-6bf3-4be7-9dee-ec48ee928202
2024-01-03 03:21:20,166 - urllib3.connectionpool - WARNING - Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f78aa8f06e0>: Failed to establish a new connection: [Errno 111] Connection refused')': /session/d807bb88-6bf3-4be7-9dee-ec48ee928202
2024-01-03 03:21:20,167 - urllib3.connectionpool - WARNING - Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f78aa8f0830>: Failed to establish a new connection: [Errno 111] Connection refused')': /session/d807bb88-6bf3-4be7-9dee-ec48ee928202
2024-01-03 03:21:20,192 - logger_realtime_data - INFO - 2024-01-03 03:21:00+08:00
2024-01-03 03:21:20,199 - logger_realtime_data - INFO - 2024-01-03 03:21:20.192728+08:00
2024-01-03 03:21:20,281 - logger_realtime_data - INFO - Traceback (most recent call last):
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "is_open" of relation "bond_yield_realtime" violates not-null constraint
DETAIL:  Failing row contains (2024-01-02 19:21:00, 1, 3.771, 1, null, null).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/app/bonds_sync_realtime.py", line 60, in write_to_database
    BondYieldRealtime(
  File "<string>", line 4, in __init__
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/state.py", line 566, in _initialize_instance
    with util.safe_reraise():
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/state.py", line 564, in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
  File "/home/app/models/bond.py", line 62, in __init__
    db.session.commit()
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/scoping.py", line 598, in commit
    return self._proxied.commit()
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1969, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1256, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1231, in _prepare_impl
    self.session.flush()
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4312, in flush
    self._flush(objects)
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4447, in _flush
    with util.safe_reraise():
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4408, in _flush
    flush_context.execute()
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1043, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "is_open" of relation "bond_yield_realtime" violates not-null constraint
DETAIL:  Failing row contains (2024-01-02 19:21:00, 1, 3.771, 1, null, null).

[SQL: INSERT INTO bond_yield_realtime (datetime, asset_id, bond_yield, timeframe) VALUES (%(datetime)s, %(asset_id)s, %(bond_yield)s, %(timeframe)s)]
[parameters: {'datetime': datetime.datetime(2024, 1, 3, 3, 21, tzinfo=<DstTzInfo 'Asia/Singapore' +08+8:00:00 STD>), 'asset_id': 1, 'bond_yield': 3.771, 'timeframe': 1}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

2024-01-03 03:22:02,102 - logger_realtime_data - INFO - entry
2024-01-03 03:22:15,753 - urllib3.connectionpool - WARNING - Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fcb03358440>: Failed to establish a new connection: [Errno 111] Connection refused')': /session/f073039c-e62f-4325-8255-06590860e309
2024-01-03 03:22:15,754 - urllib3.connectionpool - WARNING - Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fcb03358920>: Failed to establish a new connection: [Errno 111] Connection refused')': /session/f073039c-e62f-4325-8255-06590860e309
2024-01-03 03:22:15,755 - urllib3.connectionpool - WARNING - Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fcb03358b60>: Failed to establish a new connection: [Errno 111] Connection refused')': /session/f073039c-e62f-4325-8255-06590860e309
2024-01-03 03:22:15,772 - logger_realtime_data - INFO - 2024-01-03 03:22:00+08:00
2024-01-03 03:22:15,775 - logger_realtime_data - INFO - 2024-01-03 03:22:15.772517+08:00
2024-01-03 03:22:15,825 - logger_realtime_data - INFO - Traceback (most recent call last):
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "is_open" of relation "bond_yield_realtime" violates not-null constraint
DETAIL:  Failing row contains (2024-01-02 19:22:00, 1, 3.772, 1, null, null).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/app/bonds_sync_realtime.py", line 60, in write_to_database
    BondYieldRealtime(
  File "<string>", line 4, in __init__
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/state.py", line 566, in _initialize_instance
    with util.safe_reraise():
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/state.py", line 564, in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
  File "/home/app/models/bond.py", line 62, in __init__
    db.session.commit()
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/scoping.py", line 598, in commit
    return self._proxied.commit()
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1969, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1256, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1231, in _prepare_impl
    self.session.flush()
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4312, in flush
    self._flush(objects)
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4447, in _flush
    with util.safe_reraise():
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4408, in _flush
    flush_context.execute()
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1043, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "is_open" of relation "bond_yield_realtime" violates not-null constraint
DETAIL:  Failing row contains (2024-01-02 19:22:00, 1, 3.772, 1, null, null).

[SQL: INSERT INTO bond_yield_realtime (datetime, asset_id, bond_yield, timeframe) VALUES (%(datetime)s, %(asset_id)s, %(bond_yield)s, %(timeframe)s)]
[parameters: {'datetime': datetime.datetime(2024, 1, 3, 3, 22, tzinfo=<DstTzInfo 'Asia/Singapore' +08+8:00:00 STD>), 'asset_id': 1, 'bond_yield': 3.772, 'timeframe': 1}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

2024-01-03 03:23:02,463 - logger_realtime_data - INFO - entry
2024-01-03 03:23:15,469 - urllib3.connectionpool - WARNING - Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fdd7069c620>: Failed to establish a new connection: [Errno 111] Connection refused')': /session/a4c7811f-fe6a-4347-802a-c5c3c37582ef
2024-01-03 03:23:15,470 - urllib3.connectionpool - WARNING - Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fdd7069c770>: Failed to establish a new connection: [Errno 111] Connection refused')': /session/a4c7811f-fe6a-4347-802a-c5c3c37582ef
2024-01-03 03:23:15,473 - urllib3.connectionpool - WARNING - Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fdd7069c8f0>: Failed to establish a new connection: [Errno 111] Connection refused')': /session/a4c7811f-fe6a-4347-802a-c5c3c37582ef
2024-01-03 03:23:15,486 - logger_realtime_data - INFO - 2024-01-03 03:23:00+08:00
2024-01-03 03:23:15,487 - logger_realtime_data - INFO - 2024-01-03 03:23:15.486302+08:00
2024-01-03 03:23:15,535 - logger_realtime_data - INFO - Traceback (most recent call last):
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "is_open" of relation "bond_yield_realtime" violates not-null constraint
DETAIL:  Failing row contains (2024-01-02 19:23:00, 1, 3.772, 1, null, null).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/app/bonds_sync_realtime.py", line 60, in write_to_database
    BondYieldRealtime(
  File "<string>", line 4, in __init__
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/state.py", line 566, in _initialize_instance
    with util.safe_reraise():
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/state.py", line 564, in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
  File "/home/app/models/bond.py", line 62, in __init__
    db.session.commit()
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/scoping.py", line 598, in commit
    return self._proxied.commit()
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1969, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1256, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1231, in _prepare_impl
    self.session.flush()
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4312, in flush
    self._flush(objects)
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4447, in _flush
    with util.safe_reraise():
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4408, in _flush
    flush_context.execute()
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1043, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "is_open" of relation "bond_yield_realtime" violates not-null constraint
DETAIL:  Failing row contains (2024-01-02 19:23:00, 1, 3.772, 1, null, null).

[SQL: INSERT INTO bond_yield_realtime (datetime, asset_id, bond_yield, timeframe) VALUES (%(datetime)s, %(asset_id)s, %(bond_yield)s, %(timeframe)s)]
[parameters: {'datetime': datetime.datetime(2024, 1, 3, 3, 23, tzinfo=<DstTzInfo 'Asia/Singapore' +08+8:00:00 STD>), 'asset_id': 1, 'bond_yield': 3.772, 'timeframe': 1}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

2024-01-03 03:24:02,194 - logger_realtime_data - INFO - entry
2024-01-03 03:24:16,524 - urllib3.connectionpool - WARNING - Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f0d650d4620>: Failed to establish a new connection: [Errno 111] Connection refused')': /session/238e2092-f09b-4818-9d9f-89e076e3e26a
2024-01-03 03:24:16,535 - urllib3.connectionpool - WARNING - Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f0d650d4a70>: Failed to establish a new connection: [Errno 111] Connection refused')': /session/238e2092-f09b-4818-9d9f-89e076e3e26a
2024-01-03 03:24:16,549 - urllib3.connectionpool - WARNING - Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f0d650d4bf0>: Failed to establish a new connection: [Errno 111] Connection refused')': /session/238e2092-f09b-4818-9d9f-89e076e3e26a
2024-01-03 03:24:16,567 - logger_realtime_data - INFO - 2024-01-03 03:24:00+08:00
2024-01-03 03:24:16,589 - logger_realtime_data - INFO - 2024-01-03 03:24:16.567366+08:00
2024-01-03 03:24:16,677 - logger_realtime_data - INFO - Traceback (most recent call last):
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "is_open" of relation "bond_yield_realtime" violates not-null constraint
DETAIL:  Failing row contains (2024-01-02 19:24:00, 1, 3.772, 1, null, null).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/app/bonds_sync_realtime.py", line 60, in write_to_database
    BondYieldRealtime(
  File "<string>", line 4, in __init__
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/state.py", line 566, in _initialize_instance
    with util.safe_reraise():
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/state.py", line 564, in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
  File "/home/app/models/bond.py", line 62, in __init__
    db.session.commit()
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/scoping.py", line 598, in commit
    return self._proxied.commit()
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1969, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1256, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1231, in _prepare_impl
    self.session.flush()
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4312, in flush
    self._flush(objects)
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4447, in _flush
    with util.safe_reraise():
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4408, in _flush
    flush_context.execute()
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1043, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "is_open" of relation "bond_yield_realtime" violates not-null constraint
DETAIL:  Failing row contains (2024-01-02 19:24:00, 1, 3.772, 1, null, null).

[SQL: INSERT INTO bond_yield_realtime (datetime, asset_id, bond_yield, timeframe) VALUES (%(datetime)s, %(asset_id)s, %(bond_yield)s, %(timeframe)s)]
[parameters: {'datetime': datetime.datetime(2024, 1, 3, 3, 24, tzinfo=<DstTzInfo 'Asia/Singapore' +08+8:00:00 STD>), 'asset_id': 1, 'bond_yield': 3.772, 'timeframe': 1}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

2024-01-03 03:25:02,400 - logger_realtime_data - INFO - entry
2024-01-03 03:25:17,959 - urllib3.connectionpool - WARNING - Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f2af7a1c410>: Failed to establish a new connection: [Errno 111] Connection refused')': /session/0a18a80a-1e31-44d8-afc6-463c1c8e8b86
2024-01-03 03:25:17,960 - urllib3.connectionpool - WARNING - Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f2af7a1c3e0>: Failed to establish a new connection: [Errno 111] Connection refused')': /session/0a18a80a-1e31-44d8-afc6-463c1c8e8b86
2024-01-03 03:25:17,960 - urllib3.connectionpool - WARNING - Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f2af7a1c7d0>: Failed to establish a new connection: [Errno 111] Connection refused')': /session/0a18a80a-1e31-44d8-afc6-463c1c8e8b86
2024-01-03 03:25:17,975 - logger_realtime_data - INFO - 2024-01-03 03:25:00+08:00
2024-01-03 03:25:17,978 - logger_realtime_data - INFO - 2024-01-03 03:25:17.975838+08:00
2024-01-03 03:25:18,031 - logger_realtime_data - INFO - Traceback (most recent call last):
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "is_open" of relation "bond_yield_realtime" violates not-null constraint
DETAIL:  Failing row contains (2024-01-02 19:25:00, 1, 3.772, 5, null, null).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/app/bonds_sync_realtime.py", line 60, in write_to_database
    BondYieldRealtime(
  File "<string>", line 4, in __init__
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/state.py", line 566, in _initialize_instance
    with util.safe_reraise():
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/state.py", line 564, in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
  File "/home/app/models/bond.py", line 62, in __init__
    db.session.commit()
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/scoping.py", line 598, in commit
    return self._proxied.commit()
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1969, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1256, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1231, in _prepare_impl
    self.session.flush()
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4312, in flush
    self._flush(objects)
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4447, in _flush
    with util.safe_reraise():
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4408, in _flush
    flush_context.execute()
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1043, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "is_open" of relation "bond_yield_realtime" violates not-null constraint
DETAIL:  Failing row contains (2024-01-02 19:25:00, 1, 3.772, 5, null, null).

[SQL: INSERT INTO bond_yield_realtime (datetime, asset_id, bond_yield, timeframe) VALUES (%(datetime)s, %(asset_id)s, %(bond_yield)s, %(timeframe)s)]
[parameters: {'datetime': datetime.datetime(2024, 1, 3, 3, 25, tzinfo=<DstTzInfo 'Asia/Singapore' +08+8:00:00 STD>), 'asset_id': 1, 'bond_yield': 3.772, 'timeframe': 5}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

2024-01-03 03:26:01,926 - logger_realtime_data - INFO - entry
2024-01-03 03:26:25,608 - urllib3.connectionpool - WARNING - Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f182be3c470>: Failed to establish a new connection: [Errno 111] Connection refused')': /session/85d071e5-eca8-413b-975a-e08089b3c70c
2024-01-03 03:26:25,609 - urllib3.connectionpool - WARNING - Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f182be3c080>: Failed to establish a new connection: [Errno 111] Connection refused')': /session/85d071e5-eca8-413b-975a-e08089b3c70c
2024-01-03 03:26:25,610 - urllib3.connectionpool - WARNING - Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f182be3c860>: Failed to establish a new connection: [Errno 111] Connection refused')': /session/85d071e5-eca8-413b-975a-e08089b3c70c
2024-01-03 03:26:25,635 - logger_realtime_data - INFO - 2024-01-03 03:26:00+08:00
2024-01-03 03:26:25,638 - logger_realtime_data - INFO - 2024-01-03 03:26:25.635701+08:00
2024-01-03 03:26:25,732 - logger_realtime_data - INFO - Traceback (most recent call last):
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "is_open" of relation "bond_yield_realtime" violates not-null constraint
DETAIL:  Failing row contains (2024-01-02 19:26:00, 1, 3.772, 1, null, null).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/app/bonds_sync_realtime.py", line 60, in write_to_database
    BondYieldRealtime(
  File "<string>", line 4, in __init__
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/state.py", line 566, in _initialize_instance
    with util.safe_reraise():
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/state.py", line 564, in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
  File "/home/app/models/bond.py", line 62, in __init__
    db.session.commit()
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/scoping.py", line 598, in commit
    return self._proxied.commit()
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1969, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1256, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1231, in _prepare_impl
    self.session.flush()
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4312, in flush
    self._flush(objects)
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4447, in _flush
    with util.safe_reraise():
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4408, in _flush
    flush_context.execute()
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1043, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "is_open" of relation "bond_yield_realtime" violates not-null constraint
DETAIL:  Failing row contains (2024-01-02 19:26:00, 1, 3.772, 1, null, null).

[SQL: INSERT INTO bond_yield_realtime (datetime, asset_id, bond_yield, timeframe) VALUES (%(datetime)s, %(asset_id)s, %(bond_yield)s, %(timeframe)s)]
[parameters: {'datetime': datetime.datetime(2024, 1, 3, 3, 26, tzinfo=<DstTzInfo 'Asia/Singapore' +08+8:00:00 STD>), 'asset_id': 1, 'bond_yield': 3.772, 'timeframe': 1}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

2024-01-03 03:27:02,549 - logger_realtime_data - INFO - entry
2024-01-03 03:27:20,965 - urllib3.connectionpool - WARNING - Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f0ce8064380>: Failed to establish a new connection: [Errno 111] Connection refused')': /session/049b7132-367e-42fb-8fb1-e916d32241c3
2024-01-03 03:27:20,967 - urllib3.connectionpool - WARNING - Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f0ce80646e0>: Failed to establish a new connection: [Errno 111] Connection refused')': /session/049b7132-367e-42fb-8fb1-e916d32241c3
2024-01-03 03:27:20,968 - urllib3.connectionpool - WARNING - Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f0ce8064860>: Failed to establish a new connection: [Errno 111] Connection refused')': /session/049b7132-367e-42fb-8fb1-e916d32241c3
2024-01-03 03:27:20,999 - logger_realtime_data - INFO - 2024-01-03 03:27:00+08:00
2024-01-03 03:27:21,002 - logger_realtime_data - INFO - 2024-01-03 03:27:20.999773+08:00
2024-01-03 03:27:21,098 - logger_realtime_data - INFO - Traceback (most recent call last):
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "is_open" of relation "bond_yield_realtime" violates not-null constraint
DETAIL:  Failing row contains (2024-01-02 19:27:00, 1, 3.772, 1, null, null).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/app/bonds_sync_realtime.py", line 60, in write_to_database
    BondYieldRealtime(
  File "<string>", line 4, in __init__
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/state.py", line 566, in _initialize_instance
    with util.safe_reraise():
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/state.py", line 564, in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
  File "/home/app/models/bond.py", line 62, in __init__
    db.session.commit()
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/scoping.py", line 598, in commit
    return self._proxied.commit()
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1969, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1256, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1231, in _prepare_impl
    self.session.flush()
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4312, in flush
    self._flush(objects)
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4447, in _flush
    with util.safe_reraise():
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4408, in _flush
    flush_context.execute()
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1043, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "is_open" of relation "bond_yield_realtime" violates not-null constraint
DETAIL:  Failing row contains (2024-01-02 19:27:00, 1, 3.772, 1, null, null).

[SQL: INSERT INTO bond_yield_realtime (datetime, asset_id, bond_yield, timeframe) VALUES (%(datetime)s, %(asset_id)s, %(bond_yield)s, %(timeframe)s)]
[parameters: {'datetime': datetime.datetime(2024, 1, 3, 3, 27, tzinfo=<DstTzInfo 'Asia/Singapore' +08+8:00:00 STD>), 'asset_id': 1, 'bond_yield': 3.772, 'timeframe': 1}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

2024-01-03 03:28:01,775 - logger_realtime_data - INFO - entry
2024-01-03 03:28:16,658 - urllib3.connectionpool - WARNING - Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f2eec21c560>: Failed to establish a new connection: [Errno 111] Connection refused')': /session/4f30fe14-ebba-4089-aa06-016c6ce0e64e
2024-01-03 03:28:16,659 - urllib3.connectionpool - WARNING - Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f2eec21c980>: Failed to establish a new connection: [Errno 111] Connection refused')': /session/4f30fe14-ebba-4089-aa06-016c6ce0e64e
2024-01-03 03:28:16,659 - urllib3.connectionpool - WARNING - Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f2eec21cc80>: Failed to establish a new connection: [Errno 111] Connection refused')': /session/4f30fe14-ebba-4089-aa06-016c6ce0e64e
2024-01-03 03:28:16,673 - logger_realtime_data - INFO - 2024-01-03 03:28:00+08:00
2024-01-03 03:28:16,675 - logger_realtime_data - INFO - 2024-01-03 03:28:16.673271+08:00
2024-01-03 03:28:16,726 - logger_realtime_data - INFO - Traceback (most recent call last):
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "is_open" of relation "bond_yield_realtime" violates not-null constraint
DETAIL:  Failing row contains (2024-01-02 19:28:00, 1, 3.771, 1, null, null).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/app/bonds_sync_realtime.py", line 60, in write_to_database
    BondYieldRealtime(
  File "<string>", line 4, in __init__
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/state.py", line 566, in _initialize_instance
    with util.safe_reraise():
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/state.py", line 564, in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
  File "/home/app/models/bond.py", line 62, in __init__
    db.session.commit()
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/scoping.py", line 598, in commit
    return self._proxied.commit()
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1969, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1256, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1231, in _prepare_impl
    self.session.flush()
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4312, in flush
    self._flush(objects)
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4447, in _flush
    with util.safe_reraise():
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4408, in _flush
    flush_context.execute()
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1043, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "is_open" of relation "bond_yield_realtime" violates not-null constraint
DETAIL:  Failing row contains (2024-01-02 19:28:00, 1, 3.771, 1, null, null).

[SQL: INSERT INTO bond_yield_realtime (datetime, asset_id, bond_yield, timeframe) VALUES (%(datetime)s, %(asset_id)s, %(bond_yield)s, %(timeframe)s)]
[parameters: {'datetime': datetime.datetime(2024, 1, 3, 3, 28, tzinfo=<DstTzInfo 'Asia/Singapore' +08+8:00:00 STD>), 'asset_id': 1, 'bond_yield': 3.771, 'timeframe': 1}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

2024-01-03 03:29:02,365 - logger_realtime_data - INFO - entry
2024-01-03 03:29:17,137 - urllib3.connectionpool - WARNING - Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fbadcfa8770>: Failed to establish a new connection: [Errno 111] Connection refused')': /session/2d622a72-b690-428f-805b-91fd0c65b5e9
2024-01-03 03:29:17,138 - urllib3.connectionpool - WARNING - Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fbadcfa88c0>: Failed to establish a new connection: [Errno 111] Connection refused')': /session/2d622a72-b690-428f-805b-91fd0c65b5e9
2024-01-03 03:29:17,139 - urllib3.connectionpool - WARNING - Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fbadcfa8a40>: Failed to establish a new connection: [Errno 111] Connection refused')': /session/2d622a72-b690-428f-805b-91fd0c65b5e9
2024-01-03 03:29:17,152 - logger_realtime_data - INFO - 2024-01-03 03:29:00+08:00
2024-01-03 03:29:17,154 - logger_realtime_data - INFO - 2024-01-03 03:29:17.152452+08:00
2024-01-03 03:29:17,206 - logger_realtime_data - INFO - Traceback (most recent call last):
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "is_open" of relation "bond_yield_realtime" violates not-null constraint
DETAIL:  Failing row contains (2024-01-02 19:29:00, 1, 3.772, 1, null, null).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/app/bonds_sync_realtime.py", line 60, in write_to_database
    BondYieldRealtime(
  File "<string>", line 4, in __init__
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/state.py", line 566, in _initialize_instance
    with util.safe_reraise():
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/state.py", line 564, in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
  File "/home/app/models/bond.py", line 62, in __init__
    db.session.commit()
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/scoping.py", line 598, in commit
    return self._proxied.commit()
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1969, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1256, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1231, in _prepare_impl
    self.session.flush()
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4312, in flush
    self._flush(objects)
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4447, in _flush
    with util.safe_reraise():
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4408, in _flush
    flush_context.execute()
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1043, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "is_open" of relation "bond_yield_realtime" violates not-null constraint
DETAIL:  Failing row contains (2024-01-02 19:29:00, 1, 3.772, 1, null, null).

[SQL: INSERT INTO bond_yield_realtime (datetime, asset_id, bond_yield, timeframe) VALUES (%(datetime)s, %(asset_id)s, %(bond_yield)s, %(timeframe)s)]
[parameters: {'datetime': datetime.datetime(2024, 1, 3, 3, 29, tzinfo=<DstTzInfo 'Asia/Singapore' +08+8:00:00 STD>), 'asset_id': 1, 'bond_yield': 3.772, 'timeframe': 1}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

2024-01-03 03:30:01,978 - logger_realtime_data - INFO - entry
2024-01-03 03:30:17,467 - urllib3.connectionpool - WARNING - Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f91662086e0>: Failed to establish a new connection: [Errno 111] Connection refused')': /session/964b7a06-e64c-407e-a7e7-1b7bdb2c45d7
2024-01-03 03:30:17,468 - urllib3.connectionpool - WARNING - Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f91662082f0>: Failed to establish a new connection: [Errno 111] Connection refused')': /session/964b7a06-e64c-407e-a7e7-1b7bdb2c45d7
2024-01-03 03:30:17,469 - urllib3.connectionpool - WARNING - Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f9166208a10>: Failed to establish a new connection: [Errno 111] Connection refused')': /session/964b7a06-e64c-407e-a7e7-1b7bdb2c45d7
2024-01-03 03:30:17,482 - logger_realtime_data - INFO - 2024-01-03 03:30:00+08:00
2024-01-03 03:30:17,497 - logger_realtime_data - INFO - 2024-01-03 03:30:17.482515+08:00
2024-01-03 03:30:17,559 - logger_realtime_data - INFO - Traceback (most recent call last):
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "is_open" of relation "bond_yield_realtime" violates not-null constraint
DETAIL:  Failing row contains (2024-01-02 19:30:00, 1, 3.771, 30, null, null).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/app/bonds_sync_realtime.py", line 60, in write_to_database
    BondYieldRealtime(
  File "<string>", line 4, in __init__
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/state.py", line 566, in _initialize_instance
    with util.safe_reraise():
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/state.py", line 564, in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
  File "/home/app/models/bond.py", line 62, in __init__
    db.session.commit()
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/scoping.py", line 598, in commit
    return self._proxied.commit()
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1969, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1256, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1231, in _prepare_impl
    self.session.flush()
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4312, in flush
    self._flush(objects)
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4447, in _flush
    with util.safe_reraise():
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4408, in _flush
    flush_context.execute()
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1043, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "is_open" of relation "bond_yield_realtime" violates not-null constraint
DETAIL:  Failing row contains (2024-01-02 19:30:00, 1, 3.771, 30, null, null).

[SQL: INSERT INTO bond_yield_realtime (datetime, asset_id, bond_yield, timeframe) VALUES (%(datetime)s, %(asset_id)s, %(bond_yield)s, %(timeframe)s)]
[parameters: {'datetime': datetime.datetime(2024, 1, 3, 3, 30, tzinfo=<DstTzInfo 'Asia/Singapore' +08+8:00:00 STD>), 'asset_id': 1, 'bond_yield': 3.771, 'timeframe': 30}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

2024-01-03 03:31:02,250 - logger_realtime_data - INFO - entry
2024-01-03 03:31:17,177 - urllib3.connectionpool - WARNING - Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f8d0afe8740>: Failed to establish a new connection: [Errno 111] Connection refused')': /session/37c1b3ac-cb45-4167-a3b9-97a9729f10ef
2024-01-03 03:31:17,178 - urllib3.connectionpool - WARNING - Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f8d0afe80e0>: Failed to establish a new connection: [Errno 111] Connection refused')': /session/37c1b3ac-cb45-4167-a3b9-97a9729f10ef
2024-01-03 03:31:17,179 - urllib3.connectionpool - WARNING - Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f8d0afe8860>: Failed to establish a new connection: [Errno 111] Connection refused')': /session/37c1b3ac-cb45-4167-a3b9-97a9729f10ef
2024-01-03 03:31:17,191 - logger_realtime_data - INFO - 2024-01-03 03:31:00+08:00
2024-01-03 03:31:17,194 - logger_realtime_data - INFO - 2024-01-03 03:31:17.191838+08:00
2024-01-03 03:31:17,242 - logger_realtime_data - INFO - Traceback (most recent call last):
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "is_open" of relation "bond_yield_realtime" violates not-null constraint
DETAIL:  Failing row contains (2024-01-02 19:31:00, 1, 3.771, 1, null, null).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/app/bonds_sync_realtime.py", line 60, in write_to_database
    BondYieldRealtime(
  File "<string>", line 4, in __init__
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/state.py", line 566, in _initialize_instance
    with util.safe_reraise():
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/state.py", line 564, in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
  File "/home/app/models/bond.py", line 62, in __init__
    db.session.commit()
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/scoping.py", line 598, in commit
    return self._proxied.commit()
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1969, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1256, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1231, in _prepare_impl
    self.session.flush()
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4312, in flush
    self._flush(objects)
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4447, in _flush
    with util.safe_reraise():
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4408, in _flush
    flush_context.execute()
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1043, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "is_open" of relation "bond_yield_realtime" violates not-null constraint
DETAIL:  Failing row contains (2024-01-02 19:31:00, 1, 3.771, 1, null, null).

[SQL: INSERT INTO bond_yield_realtime (datetime, asset_id, bond_yield, timeframe) VALUES (%(datetime)s, %(asset_id)s, %(bond_yield)s, %(timeframe)s)]
[parameters: {'datetime': datetime.datetime(2024, 1, 3, 3, 31, tzinfo=<DstTzInfo 'Asia/Singapore' +08+8:00:00 STD>), 'asset_id': 1, 'bond_yield': 3.771, 'timeframe': 1}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

2024-01-03 03:32:01,870 - logger_realtime_data - INFO - entry
2024-01-03 03:32:15,700 - urllib3.connectionpool - WARNING - Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f9b22350140>: Failed to establish a new connection: [Errno 111] Connection refused')': /session/8cb2717c-e66e-4a65-a9e0-c2dcb35bcbb8
2024-01-03 03:32:15,701 - urllib3.connectionpool - WARNING - Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f9b223504a0>: Failed to establish a new connection: [Errno 111] Connection refused')': /session/8cb2717c-e66e-4a65-a9e0-c2dcb35bcbb8
2024-01-03 03:32:15,702 - urllib3.connectionpool - WARNING - Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f9b22350890>: Failed to establish a new connection: [Errno 111] Connection refused')': /session/8cb2717c-e66e-4a65-a9e0-c2dcb35bcbb8
2024-01-03 03:32:15,715 - logger_realtime_data - INFO - 2024-01-03 03:32:00+08:00
2024-01-03 03:32:15,718 - logger_realtime_data - INFO - 2024-01-03 03:32:15.715583+08:00
2024-01-03 03:32:15,767 - logger_realtime_data - INFO - Traceback (most recent call last):
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "is_open" of relation "bond_yield_realtime" violates not-null constraint
DETAIL:  Failing row contains (2024-01-02 19:32:00, 1, 3.771, 1, null, null).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/app/bonds_sync_realtime.py", line 60, in write_to_database
    BondYieldRealtime(
  File "<string>", line 4, in __init__
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/state.py", line 566, in _initialize_instance
    with util.safe_reraise():
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/state.py", line 564, in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
  File "/home/app/models/bond.py", line 62, in __init__
    db.session.commit()
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/scoping.py", line 598, in commit
    return self._proxied.commit()
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1969, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1256, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1231, in _prepare_impl
    self.session.flush()
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4312, in flush
    self._flush(objects)
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4447, in _flush
    with util.safe_reraise():
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4408, in _flush
    flush_context.execute()
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1043, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/conda/envs/bonds/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "is_open" of relation "bond_yield_realtime" violates not-null constraint
DETAIL:  Failing row contains (2024-01-02 19:32:00, 1, 3.771, 1, null, null).

[SQL: INSERT INTO bond_yield_realtime (datetime, asset_id, bond_yield, timeframe) VALUES (%(datetime)s, %(asset_id)s, %(bond_yield)s, %(timeframe)s)]
[parameters: {'datetime': datetime.datetime(2024, 1, 3, 3, 32, tzinfo=<DstTzInfo 'Asia/Singapore' +08+8:00:00 STD>), 'asset_id': 1, 'bond_yield': 3.771, 'timeframe': 1}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

2024-01-02 19:35:23,833 - root - INFO - Table asset already exists.
2024-01-02 19:35:23,834 - root - INFO - Table bond_yield already exists.
2024-01-02 19:35:23,835 - root - INFO - Table bond_yield_realtime already exists.
2024-01-03 03:36:02,496 - logger_realtime_data - INFO - entry
2024-01-03 03:36:18,057 - urllib3.connectionpool - WARNING - Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f47ca850530>: Failed to establish a new connection: [Errno 111] Connection refused')': /session/7a0c8410-65d4-45ff-8b8a-23ad50bdad19
2024-01-03 03:36:18,058 - urllib3.connectionpool - WARNING - Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f47ca850890>: Failed to establish a new connection: [Errno 111] Connection refused')': /session/7a0c8410-65d4-45ff-8b8a-23ad50bdad19
2024-01-03 03:36:18,059 - urllib3.connectionpool - WARNING - Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f47ca8509e0>: Failed to establish a new connection: [Errno 111] Connection refused')': /session/7a0c8410-65d4-45ff-8b8a-23ad50bdad19
2024-01-03 03:36:18,073 - logger_realtime_data - INFO - 2024-01-03 03:36:00+08:00
2024-01-03 03:36:18,076 - logger_realtime_data - INFO - 2024-01-03 03:36:18.073860+08:00
2024-01-03 03:37:02,021 - logger_realtime_data - INFO - entry
2024-01-03 03:37:16,620 - urllib3.connectionpool - WARNING - Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f984a80cef0>: Failed to establish a new connection: [Errno 111] Connection refused')': /session/8058a947-6c57-46cf-870e-41bdde905e56
2024-01-03 03:37:16,620 - urllib3.connectionpool - WARNING - Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f984a80c440>: Failed to establish a new connection: [Errno 111] Connection refused')': /session/8058a947-6c57-46cf-870e-41bdde905e56
2024-01-03 03:37:16,621 - urllib3.connectionpool - WARNING - Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f984a80d0d0>: Failed to establish a new connection: [Errno 111] Connection refused')': /session/8058a947-6c57-46cf-870e-41bdde905e56
2024-01-03 03:37:16,637 - logger_realtime_data - INFO - 2024-01-03 03:37:00+08:00
2024-01-03 03:37:16,640 - logger_realtime_data - INFO - 2024-01-03 03:37:16.637646+08:00
